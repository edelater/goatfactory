"use strict";var grid={rows:20,cols:20},flat=_.times(grid.rows*grid.cols,_.constant(0)),cache=[1,1],patternLength=5,createGrid=function(){var b=$("table"),c=void 0;_.each(flat,function(a,d){d%grid.rows===0&&(c=$("<tr/>"),b.append(c)),c.append($("<td id='"+d+"'/>"))})},attachEvents=function(){$("td").on("click",function(a){var b=parseInt(a.target.id),c=0===flat[b]?function(a){return 1}:function(a){return a+1},d=Math.floor(b/grid.rows),e=b%grid.cols,f=_.uniq(_.concat(_.times(grid.rows,function(a){return d*grid.rows+a}),_.times(grid.cols,function(a){return e+a*grid.rows})));_.each(f,function(a){flat[a]=c.apply(void 0,[flat[a]]);var b=$("#"+a),d=parseInt($(b).text()||0);d!==flat[a]&&b.addClass("yellow"),b.text(flat[a])}),setTimeout(function(){return $("td").removeClass("yellow")},100),highlightFibonacciRanges()})},highlightFibonacciRanges=function(){var b=_.max(flat);ensureCache(b);for(var c="-"+cache.join("-")+"-",d=0;d<flat.length-patternLength;d++)if(!(d%grid.cols>grid.cols-patternLength)){var e=flat.slice(d,d+5),f="-"+e.join("-")+"-",g="-"+e.reverse().join("-")+"-",h=c.indexOf(f)>-1||c.indexOf(g)>-1;if(h)for(var i=d;i<d+patternLength;i++){var j=$("#"+i).text("");flat[i]=0,j.addClass("green")}}setTimeout(function(){return $("td").removeClass("green")},1e3)},ensureCache=function(b){var c=_.max(cache);if(b>c)for(var d=1===c?2:cache.indexOf(c),e=cache[d-1],f=c;f<b;)f=e+c,e=f,cache.push(f)};createGrid(),attachEvents();